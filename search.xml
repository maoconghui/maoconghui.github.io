<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[行程提取模型设计]]></title>
    <url>%2F2019%2F01%2F05%2F1%2F</url>
    <content type="text"><![CDATA[由于终端上报的经纬度会时刻变化，即使静止状态也会使里程有细微的变化，由于时间差不确定，所以根据速度来判断车辆处于运动或静止状态。 一、运动状态的判定条件平均速度 &gt;= 0.45km/h； 二、静止状态的判定条件平均速度 &lt; 0.45km/h； 三、设计流程 四、关键技术1.判断运动状态和静止状态：平均速度大于等于0.45km/h的认为是运动状态，平均速度小于0.45km/h的认为是静止状态； 2.判断行程的起始点和结束点：（1）在时间点A时，终端为静止状态，下一个时间点B终端为运动状态，则时间点A为行程的开始时间。因为在时间点B时，里程差大于0，表示AB这个时间段内终端开始运动；（2）在时间点A时，终端为运动状态，下一个时间点B终端为静止状态，则时间点A为行程的结束时间。因为在时间点B时，里程差（一般）等于0，且平均速度小于阈值，表示AB这个时间段内终端不再运动； 3.异常数据：（1）终端上报的里程为0的数据；（2）终端上报的经纬度小于等于0的数据；（3）里程差为0但经纬度之间的半正矢距离不为0的数据；（4）平均速度大于200km/h小于260km/h的数据（定位偏差）；（5）平均速度大于260km/h的数据（数据漂移）。 4.判断是否存在夜间行驶和疲劳驾驶：（1）获取夜间行驶的时间区间：当天23:00至第二天05:00；（2）将疲劳驾驶和夜间行驶的字段初始化为0；（3）若行程的起始点和结束点的时间区间与夜间行驶的时间区间存在交集且在交集中的时间差大于5分钟，则认为存在夜间行驶，反之则不存在；（4）若行程的持续时间大于等于4小时，则认为存在疲劳驾驶。 五、详细设计思路1、获取获取车辆的GPS数据，将其转化为数据框；2、过滤掉未定位和基站定位的数据，只选取卫星定位的数据；3、过滤掉经纬度小于等于0的数据；4、修正里程为0的异常数据：（1）若第一个点的里程为0，则将其赋为和下一个不为0的点的值一样；（2）若最后一个点的里程为0，则将其赋为和上一个点的值一样；（3）若既不在第一个也不在最后一个：①若该点的上下两个点不一样且下一个点不为0，则将其赋为和下一个值一样；②反之，则将其赋为和上一个值一样。5、将发生了漂移的数据（即相邻两个时间点的平均速度大于等于260km/h）删除；6、求出相邻两个经纬度之间的半正矢距离；7、求出相邻两个时间点之间的里程差的绝对值；8、若里程差为0但半正矢距离不为0，则将半正矢距离赋值给里程差；9、求出相邻两个时间点之间的平均速度和时间差；10、将速度大于200km/h的里程差用（阈值*时间差）来表示，且速度都赋为200km/h；11、将速度大于260km/h的里程差用半正矢距离来表示，且求出此时的平均速度；12、对里程差求累加和；13、将平均速度小于0.45km/h的时间点的状态设为0，表示为静止状态，反之则设为1，表示为运动状态；14、将一段连续的时间差大于301s的时间点的状态设为0，且保留最后一个时间点，因为最后一个时间点可能为下一段行程的开始时间；15、对状态求差分，将最后一个0和最后一个1分别标记为-1和1，表示为一段行程的起始点和结束点；16、若最后一个时间点的状态为运动状态，则将其定义为结束点，状态设为1，否则设为0；17、保证起始点和终点的个数一致：（1）若第一个状态差为1 表示第一个点为运动状态，下一个点为静止状态，无法构成一段行程，则将第一个状态差赋值为0；（2）若第一个状态差为0且状态为1，表示该点与下一点都为运动状态，可以构成一段行程，则将第一个状态差赋值为-1，表示为起始点。18、定义两个数据框，分别存放行程的起始点和结束点；19、求出一段行程的结束时间和下一段行程的开始时间之间的时间差，将时间差小于301秒的两个行程合并成一个行程；20、拼接两个数据框，得到最后的行程信息，并判断是否存在夜间行驶和疲劳驾驶行为，左后得到的行程信息中包含行程的开始索引、结束索引、开始时间、结束时间、开始的经纬度、结束的经纬度、持续时间、这段行程的里程、平均速度、是否存在夜间行驶和是否存在疲劳驾驶；21、过滤掉里程小于500米或者持续时间小于5分钟的行程；22、将得到的行程的起始和结束经纬度交叉合并到一个新的数据框中，用于行程提取的可视化；23、若得到的第一条行程的开始时间与之前写入数据库中的该车辆的最后一条行程的结束时间之间的时间差小于等于301秒，则将这两条行程进行合并，即将数据库中该车辆的最后一条行程的结束时间改为当前得到的第一条行程的结束时间，里程、持续时间和速度也相应进行改变，并删除当前得到的第一条行程；24、将剩下的行程信息写入到数据库。 六、行程提取结果呼号为64708329530，2018-08-27至2018-08-30四天的行程信息如下图所示。 七、行程可视化结果将得到的行程在GoogleEarth上显示，如下图所示，其中红色的线为该终端2018-08-27至2018-08-30四天的路线，黄色的点为行程的起始点和结束点。]]></content>
      <tags>
        <tag>行程提取  GoogleEarth</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[test]]></title>
    <url>%2F2018%2F12%2F03%2Farticle%2F</url>
    <content type="text"><![CDATA[优秀的人，不是不合群，而是他们合群的人里面没有你]]></content>
      <tags>
        <tag>test 测试</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F11%2F30%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
